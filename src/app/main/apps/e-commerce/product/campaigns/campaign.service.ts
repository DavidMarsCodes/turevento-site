import { Injectable, ViewChild, Input } from "@angular/core";
import {
    HttpClient,
    HttpHeaders,
    HttpRequest,
    HttpEventType,
    HttpErrorResponse
} from "@angular/common/http";
import {
    ActivatedRouteSnapshot,
    Resolve,
    RouterStateSnapshot
} from "@angular/router";
import { BehaviorSubject, Observable, Subscription, of } from "rxjs";
import { environment } from "environments/environment";
import { AuthService } from "app/services/authentication/auth.service";
import { EcommerceProductService } from "../product.service";
import { Campaign } from "./campaign.model";
import { ContactsService } from "app/main/apps/contacts/contacts.service";
import { map, tap, last, catchError } from "rxjs/operators";
import { ImgSrcDirective } from "@angular/flex-layout";

export class FileUploadModel {
    data: File;
    state: string;
    inProgress: boolean;
    progress: number;
    canRetry: boolean;
    canCancel: boolean;
    sub?: Subscription;
    type: string;
}

@Injectable()
export class CampaignService {
    routeParams: any;
    campaigns: Campaign[] = [];
    onCampaignChanged: BehaviorSubject<any>;
    onCategoriesChanged: BehaviorSubject<any>;
    userId = this._authServices.currentUserValue.user._id;
    token = this._authServices.currentUserValue.token;
    image: any;
    idEventNow: any;
    base64Image: any;
    loadingCampaigns: boolean = false;

    allLoading: boolean = false;
    selectLoading: boolean = false;
    countStatus = 'Enviar a:'
    value = 0;
    allContacts = this._contactService.contacts.length;
    selectedContacts = this._contactService.selectedContacts.length;
    statusSendInvitation = "";
    invitedFails: any[] = [];

    selectedIndex: number = 0;
    maxNumberOfTabs: number = 3;

    emailsValidForSend: number = 0;

    loadingFile: boolean = false;

    previewUrl: any = null;
    previewLoading: boolean = false;
    previewLoadingEvent: boolean = false;
    valueOk: 0;
    fileUp: any;
    imgProductLoad: boolean = false;
    eventOpen: boolean = false;

    @Input() text = "Upload";
    @Input() param = "file";
    @Input() target = "https://file.io";

    previewUrlEvent: any;

    private files: Array<FileUploadModel> = [];

    fileData: File = null;
    nameFile: any;

    emailPattern = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;


    imageEmpty = "data:image/jpeg;base64,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AAAAAAABOEJJTQP4AAAAAABwAAD/////////////////////////////A+gAAAAA/////////////////////////////wPoAAAAAP////////////////////////////8D6AAAAAD/////////////////////////////A+gAADhCSU0EAAAAAAAAAgABOEJJTQQCAAAAAAAEAAAAADhCSU0EMAAAAAAAAgEBOEJJTQQtAAAAAAAGAAEAAAAEOEJJTQQIAAAAAAAQAAAAAQAAAkAAAAJAAAAAADhCSU0EHgAAAAAABAAAAAA4QklNBBoAAAAAAz0AAAAGAAAAAAAAAAAAAAH0AAADhAAAAAQAaQBjAG8AbgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAADhAAAAfQAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAG51bGwAAAACAAAABmJvdW5kc09iamMAAAABAAAAAAAAUmN0MQAAAAQAAAAAVG9wIGxvbmcAAAAAAAAAAExlZnRsb25nAAAAAAAAAABCdG9tbG9uZwAAAfQAAAAAUmdodGxvbmcAAAOEAAAABnNsaWNlc1ZsTHMAAAABT2JqYwAAAAEAAAAAAAVzbGljZQAAABIAAAAHc2xpY2VJRGxvbmcAAAAAAAAAB2dyb3VwSURsb25nAAAAAAAAAAZvcmlnaW5lbnVtAAAADEVTbGljZU9yaWdpbgAAAA1hdXRvR2VuZXJhdGVkAAAAAFR5cGVlbnVtAAAACkVTbGljZVR5cGUAAAAASW1nIAAAAAZib3VuZHNPYmpjAAAAAQAAAAAAAFJjdDEAAAAEAAAAAFRvcCBsb25nAAAAAAAAAABMZWZ0bG9uZwAAAAAAAAAAQnRvbWxvbmcAAAH0AAAAAFJnaHRsb25nAAADhAAAAAN1cmxURVhUAAAAAQAAAAAAAG51bGxURVhUAAAAAQAAAAAAAE1zZ2VURVhUAAAAAQAAAAAABmFsdFRhZ1RFWFQAAAABAAAAAAAOY2VsbFRleHRJc0hUTUxib29sAQAAAAhjZWxsVGV4dFRFWFQAAAABAAAAAAAJaG9yekFsaWduZW51bQAAAA9FU2xpY2VIb3J6QWxpZ24AAAAHZGVmYXVsdAAAAAl2ZXJ0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dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M2IChNYWNpbnRvc2gpIiB4bXA6Q3JlYXRlRGF0ZT0iMjAyMC0wMy0wMVQxNToxMTo0NC0wMzowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMC0wMy0wMVQxNToxMTo0NC0wMzowMCIgeG1wOk1vZGlmeURhdGU9IjIwMjAtMDMtMDFUMTU6MTE6NDQtMDM6MDAiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDQ4MDExNzQwNzIwNjgxMTgwODM4NTQyQjc0MEJBMEIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDM4MDExNzQwNzIwNjgxMTgwODM4NTQyQjc0MEJBMEIiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDowMzgwMTE3NDA3MjA2ODExODA4Mzg1NDJCNzQwQkEwQiIgZGM6Zm9ybWF0PSJpbWFnZS9qcGVnIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0iQWRvYmUgUkdCICgxOTk4KSI+DQoJCQk8eG1wTU06SGlzdG9yeT4NCgkJCQk8cmRmOlNlcT4NCgkJCQkJPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6MDM4MDExNzQwNzIwNjgxMTgwODM4NTQyQjc0MEJBMEIiIHN0RXZ0OndoZW49IjIwMjAtMDMtMDFUMTU6MTE6NDQtMDM6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDUzYgKE1hY2ludG9zaCkiLz4NCgkJCQkJPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjA0ODAxMTc0MDcyMDY4MTE4MDgzODU0MkI3NDBCQTBCIiBzdEV2dDp3aGVuPSIyMDIwLTAzLTAxVDE1OjExOjQ0LTAzOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ1M2IChNYWNpbnRvc2gpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+DQoJCQkJPC9yZGY6U2VxPg0KCQkJPC94bXBNTTpIaXN0b3J5Pg0KCQk8L3JkZjpEZXNjcmlwdGlvbj4NCgk8L3JkZjpSREY+DQo8L3g6eG1wbWV0YT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8P3hwYWNrZXQgZW5kPSd3Jz8+/+ICQElDQ19QUk9GSUxFAAEBAAACMEFEQkUCEAAAbW50clJHQiBYWVogB88ABgADAAAAAAAAYWNzcEFQUEwAAAAAbm9uZQAAAAAAAAAAAAAAAAAAAAAAAPbWAAEAAAAA0y1BREJFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKY3BydAAAAPwAAAAyZGVzYwAAATAAAABrd3RwdAAAAZwAAAAUYmtwdAAAAbAAAAAUclRSQwAAAcQAAAAOZ1RSQwAAAdQAAAAOYlRSQwAAAeQAAAAOclhZWgAAAfQAAAAUZ1hZWgAAAggAAAAUYlhZWgAAAhwAAAAUdGV4dAAAAABDb3B5cmlnaHQgMTk5OSBBZG9iZSBTeXN0ZW1zIEluY29ycG9yYXRlZAAAAGRlc2MAAAAAAAAAEUFkb2JlIFJHQiAo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1prnilY8UygANMJ4pWNNJoAaxprUpNNagBrHNNY8UpOBTS2RQA0mmscGlJ5phNAATioyc0pPNNJ4oARjzTScChjTWOR3oAbmmtSscCmHrQAjtimsc0rU2gBrGmk8UHrTXNADW+9TWPNOPNMagBKYx5pWNNJoARjxTCeaVjTSeKAGFqRjSsajbrQAE8UwmlZqaaAEPWmMac5pjHFADWpjHinHrTXPNADc00t1oY03rQAjHFNY0rGmk0ANY00mg01zzQA0mmsacTUbHJoAGPFFNbg0UAfQDNTCaUnNNY80ANJzTWanHpUZoADTC2RTm6UygAPIqMmnE/yphPNACMc01jxQ1NJoAaTSMaUnioz1oACaYaVjTTQA0tTacTkUwtg0ANc/NSE4FBPFMY5NACU1zzSseKYx5oACeajJpzGmsaAGs3FNBzQTmmlqAGtwaa54pXNNZqAENRmnE00mgBrHmmsaCc016AEY5ppNKajY5NAAetMf71KTzTaAGseaaTxSsc01ulADSeaaTSk4pp+7QA0mmMeacTg0xjzQAhOKYTmnOaYxoARuDTGNKaa5yaAGk801zg0pPNMJyaABjxUZ604mmk80ANc8fjTScCg01mxQA1utFBooA9/Y8UwmnMc00nFADS3JppoJyaQn+dADWPNNalNNc0ANprmnE1GetAATgVHTmbFNoAa1NNKzZpjNQAhOKaTSk0wnNACE0wmlJppoARjTGNOZs00mgBrNTGNKTzTWagBrdaa55pzGo2PNABTG60rNzTWPFADWbAppPNGaa3WgAY1GxpzGoyaABjgVGTmnNTSeKAEY8UxjxQx5pr0ADGmE80uaYxzQAhphPNKTzTSaAGv0pp605qjagAfrTGNKTzTWbmgBvSmM2TTmOBTCc0ANY00nNK/3qRjgUANLc0xulKTk01zmgBp601jzTieajJyaAEbpTKcxppPNACMaKYx5ooA+gTxTC3FOY4FRmgAJ4qMnNOIzTSaAEbmmGnNzTGPFACM3FNJwKCc01m5oAaTk016caYx5oAQ9KjbrT2bAphNACFsGmE0E00tg0ABamk8UHrTWOaAGk5prnmlY8UwmgBrHFNzTiajY5oAC1NJoPFNY80ANJyaax5pWNMY0ABOKY3WlY801jQA1jTSaCaaxoAaTmmscj+VOpjNmgBCaYxzSseaaxyOtACMaYacxqNjQAjHJpjHFOJphORQAjHmmN1pzGmE0AI1MJpxNNJwKAGsc0xjgUpPFMNACE01mzTmOBUZNAAajJyac5prHP40ANJ5ppOKCc01jg0ANNNc8U5jimFs0AIaKaxooA+gSc59qZRRQAx/vUxutFFADc0wnmiigBM81HRRQA0j5qbRRQAw9Kaw4oooAYetMJoooARulR0UUANccU0miigCMnimseKKKAG0wmiigBjCmn71FFADWGBUbGiigBpOBUZOaKKAGueaa5xRRQAxjikPSiigCM0wmiigBhNNY8UUUANPApjcCiigBjnFM3UUUAJ3qOiigBp+9TTRRQBGTxTSciiigBtNYYoooAjY/zprcCiigCM9aKKKAP//Z"


    /**
     * Constructor
     *
     * @param {HttpClient} _httpClient
     */
    constructor(
        private _httpClient: HttpClient,
        private _authServices: AuthService,
        public _productService: EcommerceProductService,
        public _contactService: ContactsService
    ) {
        // Set the defaults
        this.onCategoriesChanged = new BehaviorSubject({});
        this.onCampaignChanged = new BehaviorSubject({});
    }

    /**
     * Resolver
     *
     * @param {ActivatedRouteSnapshot} route
     * @param {RouterStateSnapshot} state
     * @returns {Observable<any> | Promise<any> | any}
     */

    /**
     * Get product
     *
     * @returns {Promise<any>}
     */

    getCategories(): Promise<any> {
        return new Promise((resolve, reject) => {
            this._httpClient
                .get("api/academy-categories")
                .subscribe((response: any) => {
                    this.onCategoriesChanged.next(response);
                    resolve(response);
                }, reject);
        });
    }

    getCampaigns(): Promise<any> {
        this.loadingCampaigns = true;
        return new Promise((resolve, reject) => {
            // console.log('eventId', this.eventId)
            console.log(
                "this._authServices.currentUserValue",
                this._authServices.currentUserValue
            );

            this._httpClient
                .get(environment.apiUrl + "/api/campaign-user/" + this.userId)
                .subscribe((response: any) => {
                    const allCampaigs = response.campaigns;

                    const campByEvent = allCampaigs.filter(
                        x => x.eventId === this._productService.idNowEvent
                    );

                    console.log(
                        "map by id:",
                        this._productService.idNowEvent,
                        campByEvent
                    );

                    this.campaigns = campByEvent;
                    this.onCampaignChanged.next(this.campaigns);

                    this.loadingCampaigns = false;
                    resolve(response);
                }, reject);
        });
    }

    /**
     * Save product
     *
     * @param product
     * @returns {Promise<any>}
     */

    addCampaign(campaign): Promise<any> {
        return new Promise((resolve, reject) => {
            this._httpClient
                .post(environment.apiUrl + "/api/campaign/add-new-campaign", {
                    user: this.userId,
                    codeEvent: this._productService.idNowEvent,
                    affair: campaign.affair,
                    sender: campaign.sender,
                    nameSender: campaign.nameSender,
                    imgBlob: this.previewUrl? this.previewUrl : this.imageEmpty,
                    footer: campaign.footer,
                    messageConfirm: campaign.messageConfirm,
                    messageCancel: campaign.messageCancel,
                    webLinkCharge: campaign.webLinkCharge,
                    webLink: campaign.webLink,
                    imgTitle: campaign.imgTitle
                })
                .subscribe((response: any) => {
                    this.campaigns.push(response.post);
                    this.onCampaignChanged.next(this.campaigns);

                    resolve(response);
                }, reject);
        });
    }

    deleteCampaign(campaign) {
        console.log(campaign);

        return new Promise((resolve, reject) => {
            this._httpClient
                .delete(
                    environment.apiUrl + "/api/delete-campaign/" + campaign._id
                )
                .subscribe((response: any) => {
                    resolve(response);

                    const campaignIndex = this.campaigns.indexOf(campaign);
                    this.campaigns.splice(campaignIndex, 1);

                    this.onCampaignChanged.next(this.campaigns);

                    console.log(response);
                }, reject);
        });
    }

    editCampaign(campaign): Promise<any> {
        return new Promise((resolve, reject) => {
            this._httpClient
                .post(environment.apiUrl + "/api/campaign/edit", {
                    //user: this.userId,
                    campaignId: campaign.id,
                    affair: campaign.affair,
                    sender: campaign.sender,
                    nameSender: campaign.nameSender,
                    imgBlob: this.previewUrl,
                    messageConfirm: campaign.messageConfirm,
                    messageCancel: campaign.messageCancel,
                    footer: campaign.footer,
                    webLinkCharge: campaign.webLinkCharge,
                    webLink: campaign.webLink,
                    imgTitle: campaign.imgTitle
                })
                .subscribe((response: any) => {
                    resolve(response);
                    console.log(response);

                    this.getCampaigns().then(x => {
                        // this.loadingContact = false;
                    });
                });
        });
    }


    ManiInvited(campaign, array){

        console.log('MAin invited :', campaign, array)

        const arrayInvitedAll = array;
        const arrayNew = [];
        arrayInvitedAll.forEach(c => {
            if (c.email) {

                if (this.emailPattern.test(c.email))

                {
                    console.log('valid!')
                    arrayNew.push(c);

                }

                else {

                    console.log('inivalid email', c)
                }
               
            } else {
               
                console.log('no existe', c)
            }
        });


        this.allLoading = true;

        let arrayvalidEmials = arrayNew.map(obj => obj._id);

        console.log('emails valids' ,arrayvalidEmials)


        
        let valueOk = 0;
        let valueBad = 0;

        let totalCount = arrayvalidEmials.length

        this.statusSendInvitation = "Enviando...";

        this.countStatus = "Enviando a: " + totalCount;
       

        this.sendManiInvited(campaign, arrayNew)

        .then( (res) => {
            console.log('res', res)


            console.log('value', this.value )

            this.value = totalCount;

                console.log('completed')



                this.countStatus = "Enviados: " + this.value + " de " + totalCount;

                this.statusSendInvitation = "Completado!";

        

            
        })
        .catch((err) => {

            this.value++

            valueBad++;

            if(this.value === arrayvalidEmials.length) {


                console.log('completed')

                
            
                this.countStatus = "Enviados: " + this.valueOk + " de " + totalCount;

                this.statusSendInvitation = "Completado!";

            }

            
            console.log(err)
        })

    }

    getDataPersonForSendEmail(campaign, option, array) {


        const totalCount = array.length;

        console.log(
            "contacts selects: ",
            this._contactService.selectedContacts
        );

        if (option === "all") {
            this.allLoading = true;

            console.log("allllll");
            const arrayInvitedAll = array;
            const arrayNew = [];
            arrayInvitedAll.forEach(c => {
                if (c.email) {
                    arrayNew.push(c);
                } else {
                    return;
                }
            });


            console.log(arrayNew)

            this.emailsValidForSend = arrayNew.length;

            this.sendManiInvited(campaign._id, arrayNew)

            .then( (res) => {
                console.log('res', res)
            })
            .catch((err) => {
                console.log(err)
            })


           this.invitedArrayforSend(arrayNew, campaign, this.emailsValidForSend);
        } else {
            this.selectLoading = true;



            const arrayInvitedSelected = this._contactService.selectedContacts;

            console.log("allllll");
            
            const arrayNewSelection = [];

            arrayInvitedSelected.forEach(obj => {

                console.log(obj)
               const filter = array.filter(element => element._id === obj);

               console.log(filter)

               if(filter[0].email){

                arrayNewSelection.push(filter[0])

               }

            });

                           
            this.emailsValidForSend = arrayNewSelection.length;

            this.sendSelection(campaign, arrayNewSelection,  this.emailsValidForSend);
           
        }
    }


    getContacts(idEvent): Promise<any> {
        return new Promise((resolve, reject) => {
            this._httpClient
                .get(environment.apiUrl + "/api/invited/event/" + idEvent)
                .subscribe((response: any) => {


                
                    resolve(response);
                }, reject);
        });
    }


    invitedArrayforSend(array, invitation, totalCount) {
        setTimeout(() => {
            array.forEach(obj => {

                this.statusSendInvitation = "Enviando...";

                this.countStatus = "Enviando a: " + totalCount;
               
                console.log(obj)
             
                    if (obj.email) {
                        this.sendInvited(invitation, obj)
                            .then(mail => {

                                this.value++;

                               
                                this.valueOk++;

                                console.log(mail,  this.value)

                                let id = mail.resBody.Messages[0].To[0].MessageID;
                                   
                                this._contactService.editMessageId(obj._id, id)
                                .then(() => {
                                    this._productService.Is_mailJet()
                                    
                                })
                           

                                if (this.value === totalCount) {
                                    this.value = totalCount;

                                    this.countStatus = "Enviados: " + this.valueOk + " de " + totalCount;

                                    this.statusSendInvitation = "Completado!";
                                }
                            })
                            .catch(err => {
                                this.value++;

                             
          
                                        console.log(err);

                                        this.invitedFails.push(obj);

                                        console.log(this.invitedFails);

                                      
                                

                                if (this.value === totalCount) {
                                    this.value = totalCount;


                                    this.countStatus = "Enviados: " + this.valueOk + " de " + totalCount;


                                    this.statusSendInvitation = "Completado!";

                                }
                            });
                    }
            });
        }, 500);
    }


    sendSelection(invitation, array, totalCount)
    {


        this.countStatus = "Enviando a: " + totalCount;
        this.statusSendInvitation = "Enviando...";
 console.log('' ,array)
        
        setTimeout(() => {
            
            array.forEach(obj => {

                console.log(obj, invitation)

             
                    if (obj.email) {
                        this.sendInvited(invitation, obj)
                            .then(mail => {

                               
                                this.value++;

                                console.log(mail,  this.value)

                                let id = mail.resBody.Messages[0].To[0].MessageID;

                                this._contactService.editMessageId(obj._id, id)
                                .then(() => {
                                    this._productService.Is_mailJet()
                                    
                                })

                                if (this.value === totalCount) {
                                    this.value = totalCount;

                                    this.countStatus = "Enviados: " + this.value + " de " + totalCount;

                                    this.statusSendInvitation = "Completado!";
                                }
                            })
                            .catch(err => {
                                this.value++;

                             
          
                                        console.log(obj);

                                        this.invitedFails.push(obj);

                                        console.log(this.invitedFails);

                                      
                                

                                if (this.value === totalCount) {
                                    this.value = totalCount;

                                    this.countStatus = "Enviados: " + this.value + " de " + totalCount;

                                    this.statusSendInvitation = "Completado!";

                                }
                            });
                    }

                })
         
        }, 500);
    }

    sendInvited(invitation, person): Promise<any> {
        console.log(invitation);
        const imagen = invitation.imgBlob.substr(22);

        const obj = {
            _id: invitation._id,
            affair: invitation.affair,
            nameSender: invitation.nameSender,
            sender: invitation.sender,
            imgBlob: imagen,
            _idInvited: person._id,
            emailInvited: person.email,
            nameInvited: person.name + " " + person.lastname
        };

        return new Promise((resolve, reject) => {
            this._httpClient
                .post<any>(`${environment.apiUrl}/api/send-invited`, obj)
                .subscribe((response: any) => {
                    resolve(response);
                    console.log(response);
                }, reject);
        });
    }

    uploadFile(file: FileUploadModel) {
        this.loadingFile = true;
        const fd = new FormData();
        fd.append(this.param, file.data);

        const req = new HttpRequest("POST", this.target, fd, {
            reportProgress: true
        });

        file.inProgress = true;
        file.sub = this._httpClient
            .request(req)
            .pipe(
                map(event => {
                    switch (event.type) {
                        case HttpEventType.UploadProgress:
                            file.progress = Math.round(
                                (event.loaded * 100) / event.total
                            );
                            break;
                        case HttpEventType.Response:
                            this.fileUp = event.body;
                            setTimeout(() => {
                                this.loadingFile = false;
                            }, 800);

                            return event;
                    }
                }),
                tap(message => {}),
                last(),
                catchError((error: HttpErrorResponse) => {
                    file.inProgress = false;
                    file.canRetry = true;
                    return of(`${file.data.name} upload failed.`);
                })
            )
            .subscribe((event: any) => {});
    }

    fileProgress(fileInput: any, type) {
        this.fileData = <File>fileInput;

        console.log(this.fileData);

        this.preview(type);
    }

    preview(type) {
        // Show preview
        var mimeType = this.fileData.type;
        if (mimeType.match(/image\/*/) == null) {
            return;
        }

        var reader = new FileReader();
        reader.readAsDataURL(this.fileData);
        reader.onload = _event => {
            if (type === "camp") {
                this.previewUrl = reader.result;

                this.image = this.previewUrl;

                console.log(this.image);

                this.previewLoading = true;
            } else {
                this.imgProductLoad = true;

                this.previewUrlEvent = reader.result;
            }
        };
    }

sendManiInvited(campaign, array): Promise<any> {

        return new Promise((resolve, reject) => {
        this._httpClient
        .post<any>(environment.apiUrl + '/api/mani-invited', { campaign, array } )                
        .subscribe((response: any) => {

                console.log(response);
                resolve(response);
               
            }, reject);
    });
}

    

    mailJetStatusTo(id): Promise<any> {

        console.log('id', id)
        return new Promise((resolve, reject) => {
            this._httpClient
            .get<any>(`${environment.apiUrl}/api/status-to-mailjet/${id}`,)                
            .subscribe((response: any) => {


                    console.log(response);
                    resolve(response);
                   
                }, reject);
        });
    }

    

    
}
